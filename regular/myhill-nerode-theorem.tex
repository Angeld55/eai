\section{Минимален автомат}
\begin{framed}
  \begin{thm}[Майхил-Нероуд]
    \label{th:myhill-nerode}
    \index{Майхил-Нероуд!теорема}
    Нека $L\subseteq \Sigma^\star$ е регулярен език.
    Тогава съществува ДКА $\M = \FA$, който разпознава $L$
    с точно толкова състояния, колкото са класовете на еквивалентност на релацията $\approx_L$,
    т.е. $\abs{Q} = \abs{\Sigma^\star/_{\approx_L}}$.
  \end{thm}  
\end{framed}
\begin{proof}
  % \mynote{стр. 96 от \cite{papadimitriou}}
  \mynote{на англ. Myhill-Nerode}
  Ще дефинираме ДКА $\M = \FA$, разпознаващ $L$, като:
  \begin{itemize}
  \item
    $Q \df \{\ [\alpha]_L\mid \alpha\in \Sigma^\star\ \}$;
  \item
    $\qstart \df [\varepsilon]_L$;
  \item
    $F \df \{\ [\alpha]_L\mid \alpha\in L\ \} = \{\ [\alpha]_L \mid [\alpha]_L \subseteq L\ \}$;
  \item
    Определяме изображението $\delta$ като 
    за всяка буква $x \in \Sigma$ и всяко състояние $[\alpha]_L\in Q$, 
    \[\delta([\alpha]_L,x) \df [\alpha x]_L.\]
  \end{itemize}
  
  Първо, трябва да се уверим, че множеството от състояния $Q$ е крайно, т.е.
  релацията $\approx_L$ има крайно много класове на еквивалентност.
  И така, тъй като $L$ е регулярен език, то той се разпознава от някой ДКА $\A$.
  От \Proposition{upper-bound} имаме, че $\abs{Q^{\A}} \geq \abs{\Sigma^\star/_{\approx_L}}$.
  Понеже $Q^{\A}$ е крайно множество, то $\approx_L$ има крайно много класове и 
  следователно $Q$ също е крайно множество.

  Второ, трябва да се уверим, че изображението $\delta$ задава функция, т.е. 
  да проверим, че за всеки две думи $\alpha$, $\beta$ и всяка буква $x$,
  \[[\alpha]_L = [\beta]_L \implies \delta([\alpha]_L,x) = \delta([\beta]_L,x).\]
  Но това се вижда веднага,  защото
  \mynote{Функцията на преходите $\delta$ е дефинирана чрез произволен представител на всеки клас на еквивалентност относно $\approx_L$. Трябва да съобразим,
    че няма значение кой представител сме избрали.}
  \begin{align*}
    [\alpha]_L = [\beta]_L & \implies \underbrace{[\alpha x]_L}_{\delta([\alpha]_L,x)} = \underbrace{[\beta x]_L}_{\delta([\beta]_L,x)}. & \comment{\text{свойство на }\approx_L}
  \end{align*}
  
  Така вече сме показали, че $\M$ е коректно зададен детерминиран краен автомат.
  \mynote{Вече знаем, че $L = \L(\B)$.}
  Остава да покажем, че $\M$ разпознава езика $L$, т.е. $\L(\M) = L$.
  За целта е достатъчно да докажем, че $\M \cong \B$, където $\B$ е автоматът построен по метода на Бжозовски за $L$.
  За целта, нека дефинираме $f:Q^\M \to Q^\B$ по следния начин:
  \[f([\omega]_L) \df \omega^{-1}(L).\] 
  \begin{itemize}
  \item
    Лесно се вижда, че $f$ е биекция.
  \item
    $\qstart^\M = \qstart^\B$;
  \item
    $[\omega]_L \in F^\M \iff \omega \in L \iff \varepsilon \in \omega^{-1}(L) \iff f([\omega]_L) \in F^\B$;
  \item
    Понеже $(\omega a)^{-1}(L) = a^{-1}(\omega^{-1}(L))$, то
    \begin{align*}
      f(\delta_\M([\omega]_L,a)) & = f([\omega a]_L)\\
                                 & = (\omega a)^{-1}(L)\\
                                 & = a^{-1}(\omega^{-1}(L))\\
                                 & = \delta_\B(f([\omega]_L),a).
    \end{align*}
  \end{itemize}
  Заключваме, че $\M \cong_f \B$ и следователно $\L(\M) = \L(\B) = L$.
  
  % За целта, първо ще докажем едно помощно твърдение.
  % \begin{proposition}
  %   За всеки две думи $\alpha$ и $\beta$ е изпълнено, че:
  %   \begin{equation}
  %     \label{eq:4}
  %     \delta^\star([\alpha]_L,\beta) = [\alpha\beta]_L.
  %   \end{equation}
  % \end{proposition}
  % \begin{proof}
  %   Ще докажем това свойство с индукция по дължината на думата $\beta$.
  %   \begin{itemize}
  %   \item
  %     Нека $|\beta| = 0$, т.е. $\beta = \varepsilon$. В този случай, свойството следва директно от дефиницията на $\delta^\star$, т.е.
  %     \[\delta^\star([\alpha]_L,\varepsilon) = [\alpha]_L.\]
  %   \item
  %     Да приемем, че свойството (\ref{eq:4}) е изпълнено за всички думи $\beta$ с дължина $n$.
  %   \item
  %     Нека $\abs{\beta} = n+1$. Тогава $\beta = \gamma a$, където $\abs{\gamma} = n$.
  %     В този случай, свойството (\ref{eq:4}) следва от следните равенства:
  %     \begin{align*}
  %       \delta^\star([\alpha]_L, \gamma a) & = \delta(\delta^\star([\alpha]_L,\gamma),a) & \comment{\text{деф. на }\delta^\star}\\
  %                                         & = \delta([\alpha\gamma]_L,a) & \comment{\text{от {\bf И.П.} за }\gamma}\\
  %                                         & = [\alpha\gamma a]_L & \comment{\text{от деф. на }\delta}\\
  %                                         & = [\alpha\beta]_L & \comment{\beta = \gamma a}.
  %     \end{align*}
  %   \end{itemize}
  % \end{proof}
  % \noindent За да се убедим, че $L = \L(\M)$ е достатъчно да проследим еквивалентностите:
  % \begin{align*}
  %   \alpha\in \L(\M) & \iff \delta^\star(\qstart,\alpha) \in F & \comment{\text{деф. на }\L(\M)}\\
  %                    & \iff \delta^\star([\varepsilon]_L,\alpha) \in F & \comment{\qstart \df [\varepsilon]_L}\\
  %                    & \iff \delta^\star([\varepsilon]_L,\alpha) = [\varepsilon\alpha]_L\in F & \comment{\text{от (\ref{eq:4})}}\\
  %                    & \iff [\alpha]_L \in F \\
  %                    & \iff \alpha\in L & \comment{\text{деф. на }F}.
  % \end{align*}
\end{proof}

\begin{problem}
  Докажете, че за всеки две думи $\alpha$ и $\beta$ е изпълнено, че:
  \[\delta^\star_\M([\alpha]_L,\beta) = [\alpha\beta]_L.\]
  Оттук заключете директно, че $\L(\M) = L$.
\end{problem}


Следващата теорема ни казва, че минималният автомат е единствен с точност до изоморфизъм.

\begin{framed}
  \begin{thm}
    \label{th:regular:isomorphic:minimal}
    Нека регулярният език $L$ се разпознава от детерминирания краен автомат 
    $\A = \FA$, за който $\abs{Q} = \abs{\Sigma^\star/_{\approx_L}}$.
    Тогава $\A \cong \M$, където $\M$ е автоматът построен според \hyperref[th:myhill-nerode]{Теоремата на Майхил-Нероуд} за езика $L$.
  \end{thm}  
\end{framed}
\begin{proof}
  \mynote{Съобразете, че $\A$ е {\em свързан}, т.е. всяко състояние на $\A$ е достижимо от началното.}
  Нека положим $q_\alpha \df \delta^\star_\A(\qstart, \alpha)$.
  Да дефинираме функцията $h:\Sigma^\star/_{\approx_L} \to Q$ по следния начин:
  \[h([\alpha]_L) \df q_\alpha.\]
  Ще докажем, че $h$ задава изоморфизъм на $\A$ върху $\M$. 
  \begin{enumerate}[(1)]
  \item
    Понеже $|\Sigma^\star/_{\approx_L}| = |Q|$, от \Proposition{bijection-classes} знаем, че $h$ е биекция.
  \item
    Понеже $q_\varepsilon = \qstart$,
    то е ясно, че
    \[h([\varepsilon]_L) \df \qstart.\]
  \item
    Също лесно се съобразява, че
    \begin{align*}
      [\alpha]_L \in F^\M  & \iff \alpha \in L & \comment\text{деф. на } F^\M\\
                          & \iff \alpha \in \L(\A) & \comment{L = \L(\A)}\\
                          & \iff q_\alpha \in F^\A & \comment\text{деф. на }\L(\A)\\
                          & \iff h([\alpha]_L) \in F^\A. & \comment\text{деф. на }h
    \end{align*}
  \item
    За последно оставихме проверката, че $h$ наистина е {\bf изоморфизъм}:
    \begin{align*}
      h(\delta_\M([\alpha]_L,b)) & = h([\alpha b]_L) & \comment\text{деф. на }\delta_\M\\
                                 & = q_{\alpha b} & \comment\text{деф. на }h\\
                                 & = \delta_\A(\delta^\star_\A(\qstart,\alpha), b) & \comment\text{деф. на }\delta^\star_\A\\
                                 & = \delta_\A( h([\alpha]_L), b). & \comment\text{деф. на }h
    \end{align*}
  \end{enumerate}
\end{proof}

\begin{framed}
  \begin{corollary}\label{cor:regular:minimal-isomorphic}
    За регулярния език $L$, нека имаме детерминираните крайни автомати $\A_1$ и $\A_2$, които разпознават $L$.
    Ако $|Q_1| = |Q_2| = |\Sigma^\star/_{\approx_L}|$, то $\A_1 \cong \A_2$.
  \end{corollary}
\end{framed}
\begin{hint}
  $\A_1 \cong \M\ \&\ \A_2 \cong \M \implies \A_1 \cong \A_2$.
\end{hint}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../eai"
%%% End:
