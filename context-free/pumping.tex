\section{Лема за покачването}

\begin{itemize}
\item 
  {\bf Дължина} на път в дърво е броят на ребрата по този път.
\item
  {\bf Височина} на дърво е максималната дължина на път в дървото.
\end{itemize}


\begin{prop}
  \label{pr:height-tree}
  \marginpar{Помислете как трябва да модифицирате това твърдение, ако не изисквате граматиката да е в НФЧ}
  Нека $G$ е в нормална форма на Чомски и думата $\omega \in \L(G)$ има дължина $|\omega| > 2^{n-1}$, за $n \geq 1$.
  Тогава съществува дърво на извод в $G$ на думата $\omega$ с височина $\geq n+1$.
\end{prop}
\begin{hint}
  По-лесно е да се докаже контрапозицията на горното твърдение, т.е.
  ако $\omega \in \L(G)$ има дърво на извод с височина $\leq n$, то $|\omega| \leq 2^{n-1}$.
  Докажете с индукция по $n \geq 1$.
\end{hint}

\begin{lemma}[за покачването (безконтекстни езици)]
  \index{лема за покачването!безконтекстни езици}
  \label{lem:pumping-context} 
  \marginpar{\cite[стр. 123]{sipser1}, \cite[стр. 125]{hopcroft1}, \cite[стр. 148]{kozen}}
  За всеки безконтекстен език $L$ съществува $p>0$, такова
  че ако $\alpha\in L, \abs{\alpha} \geq p$, то съществува разбиване на думата на пет части, $\alpha=xyuvw$,
  \marginpar{Ще казваме, че $p$ е константа на покачването}
  за което е изпълнено:
  \begin{enumerate}[1)]
  \item
    $\abs{yv}\geq 1$,
  \item
    $\abs{yuv}\leq p$, и
  \item
    $(\forall i\geq 0)[xy^iuv^iw\in L]$.
\end{enumerate}
\end{lemma}
\begin{proof}
  Нека $G$ е граматиката за езика $L$ в нормална форма на Чомски.
  \marginpar{Възлите във вътрешността на дървото са променливи, а листата са букви}
  Нека $p = 2^{\abs{V}}$. Ще покажем, че $p$ е константа на покачването за граматиката $G$.
  
  Нека $\abs{\alpha} \geq p = 2^{\abs{V}}$. 
  Тогава от \Prop{height-tree} следва, че щом $|\alpha| > 2^{|V| - 1}$, то $\alpha$
  има дърво на извод $T_\alpha$ с дължина $\geq |V|+1$. Това означава, че има път в $T_\alpha$
  с поне $|V|+2$ върха.
  Да фиксираме един такъв път $\pi$ с максимална възможна дължина.
  Да разгледаме последните $|V|+1$ върха по пътя $\pi$, с които сме асоциирали променливи.
  От принципа на Дирихле следва, че измежду тези $|V|+1$ променливи има поне една повтаряща се.
  Нека да тръгнем от листото нагоре към върха по пътя $\pi$ и да отбележим първите два върха $r_2$ и $r_1$,
  с които е асоциирана една и съща променлива, която означаваме с $X$.
  \marginpar{По пътя $\pi$ е възможно да срещнем много различни двойки повтарящи се променливи, ние избрахме възможно най-долната.}
  Нека поддървото на $T$ с връх $r_2$ да извежда думата $u$.
  Тогава поддървото на $T$ с връх $r_1$ извежда думата $yuv$, за някои думи $y,v \in \Sigma^\star$.
  Това означава, че думата $\alpha$ може да се запише като $\alpha = xyuvw$, за някои $x, w \in \Sigma^\star$.
  Освен това имаме свойствата:
  \begin{enumerate}[1)]
  \item
    $\abs{yv}\geq 1$,
    защото граматиката е в нормална форма на Чомски.
    За да получим, че $|yv| = 0$, то трябва да имаме правила от вида $X \to Y$ или $X \to \varepsilon$.
  \item
    $\abs{yuv} \leq p$, защото сме избрали най-долната повтаряща се двойка от променливи.
  \item
    $xy^iuv^iw \in L$, защото можем да заменим поддървото 
    с корен $r_2$ с поддървото с корен $r_1$.
    В случая $i = 0$, заменяме поддървото с корен $r_1$ с това с корен $r_2$.
  \end{enumerate}
\end{proof}

\begin{cor}
  \label{cor:pumping-context-free}
  \marginpar{Ако $L$ е краен език, то е ясно, че $L$ е безконтекстен.}
  Нека $L$ е произволен {\bf безкраен} език. Нека също така е изпълнено, че:
  \begin{description}
  \item[($\forall$)]
    за {\em всяко} естествено число $p \geq 1$,
  \item[($\exists$)]
    можем да намерим дума $\alpha \in L$, $\abs{\alpha}\geq p$, такава че
  \item[($\forall$)]
    за {\em всяко} разбиване на думата на пет части, $\alpha = xyuvw$, със свойствата $\abs{yv} \geq 1$ и $\abs{yuv} \leq p$,
  \item[($\exists$)]
    можем да посочим $i \in \Nat$, за което е изпълнено, че $xy^iuv^iw \not\in L$.
  \end{description}  
  \marginpar{\writedown Докажете! Аналогично е на \Cor{pumping-reg}}
  Тогава $L$ {\bf не} е безконтекстен език.
\end{cor}

\begin{cor}
  \marginpar{\writedown Докажете!}
  Нека $G$ е безконтекстна граматика и $p$ е константата на покачването за $G$.
  Тогава $\abs{\L(G)} = \infty$ точно тогава, когато съществува $\alpha \in \L(G)$, за която $p \leq \abs{\alpha} < 2p$.
\end{cor}
% \begin{proof}
%   Ако съществува дума $\alpha \in L$, за която $\abs{\alpha} \geq p$, то от \Lem{pumping-context} следва,
%   че $\abs{L} = \infty$, защото $\alpha = xyuvw$ и $xy^iuv^iw \in L$, за всяко $i\in\Nat$.

%   За другата посока, нека сега $\abs{L} = \infty$.
%   Да изберем най-късата дума $\alpha \in L$, за която $\abs{\alpha} \geq p$.
%   Ще докажем, че $p \leq \abs{\alpha} < 2p$. За целта да допуснем, че $\abs{\alpha} \geq 2p$.
%   Тогава от \Lem{pumping-context} следва, че $\alpha = xyuvw$, $\abs{yv} \geq 1$, $\abs{yuv} \leq p$, $xy^0uv^0w = xuw \in L$.
%   Ако $\abs{xuw} < p$, то $\abs{yv} > p$, защото $\abs{yv} + \abs{xuw} = \abs{\alpha} \geq 2p$, и следователно $\abs{yuv} > p$, което е противоречие.
%   Следва, че $\abs{\alpha} > \abs{xuw} \geq p$.
%   Получихме, че думата $xuw\in L$ и $\abs{xuw} \geq p$. Това е противоречие с минималността на $\alpha$.
% \end{proof}

% \begin{framed}
%   \Lem{pumping-context} е полезна, когато искаме да докажем, че даден език $L$ {\bf не} е безконтекстен.
%   За целта, доказваме отрицанието на свойствата от \Lem{pumping-context} за $L$, т.е.
%   за всяка константа $p$, ние намираме дума $\alpha \in L$, $\abs{\alpha}\geq p$, такава че за всяко разбиване на думата на пет части, $\alpha = xyuvw$,
%   със свойствата $\abs{yv} \geq 1$ и $\abs{yuv} \leq p$, е изпълнено, че $(\exists i)[xy^iuv^iw \not\in L]$.
% \end{framed}

\begin{remark}
  Алгоритъм за проверка дали един безконтекстен език е безкраен следвайки горния критерий би 
  имал експоненциална сложност относно $|G|$.
\end{remark}


\begin{problem}
  \label{pr:anbncn}
  Докажете, че езикът $L = \{a^nb^nc^n\ \mid\ n\in\Nat\}$ не е безконтекстен.
\end{problem}
\begin{proof}
  \begin{description}
  \item[$(\forall)$]
    Разглеждаме произволна константа $p \geq 1$.
  \item[$(\exists)$]
    Избираме дума $\alpha \in L$, $\abs{\alpha} \geq p$.
    В случая, нека $\alpha = a^pb^pc^p$.
  \item[$(\forall)$]
    Разглеждаме произволно разбиване $xyuvw = \alpha$, за което $\abs{yuv} \leq p$ и $1 \leq \abs{yv}$.
  \item[$(\exists)$]
    Ще изберем $i$, за което $xy^iuv^iw \not\in L$.
    Знаем, че поне едно от $y$ и $v$ не е празната дума.
    Имаме няколко случая за $y$ и $v$.
    \begin{itemize}
    \item
      $y$ и $v$ са думи съставени от една буква.
      В този случай получаваме, че $xy^2uv^2w$ има различен брой букви $a$, $b$ и $c$.
    \item
      $y$ или $v$ е съставена от две букви.
      Тогава е възможно да се окаже, че $xy^2uv^2w$ да има равен брой $a$, $b$ и $c$,
      но тогава редът на буквите е нарушен.
    \item
      понеже $\abs{yuv} \leq p$, то не е възможно в $y$ или $v$ да се срещат и трите букви.
    \end{itemize}  
    Оказа се, че във всички възможни случаи за $y$ и $v$, 
    $xy^2uv^2w \not\in L$.
  \end{description}
  Така от \Cor{pumping-context-free} следва, че езикът $L$ не е безконтекстен.
\end{proof}

\begin{problem}
  Докажете, че $L = \{a^ib^jc^k\ \mid\ 0 \leq i \leq j \leq k\}$ не е безконтекстен език.
\end{problem}
\begin{proof}
  \begin{description}
  \item[$(\forall)$]
     Разглеждаме произволна константа $p \geq 1$.
   \item[$(\exists)$]
     Избираме дума $\alpha \in L$, $\abs{\alpha} \geq p$.
     В случая, нека $\alpha = a^pb^pc^p$.
   \item[$(\forall)$]
     Разглеждаме произволно разбиване $xyuvw = \alpha$, за което $\abs{yuv} \leq p$ и $1 \leq \abs{yv}$.
     Знаем, че поне една от $y$ и $v$ не е празната дума.
   \item[$(\exists)$] Ще намерим $i \in \Nat$, за което $xy^iuv^iw \not\in L$.
    \begin{itemize}
    \item
      $y$ и $v$ са съставени от една буква.
      Имаме три случая.
      \begin{enumerate}[i)]
      \item
        $a$ не се среща в $y$ и $v$.
        Тогава $xy^0vu^0w$ съдържа повече $a$ от $b$ или $c$.
      \item
        $b$ не се среща в $y$ и $v$.
        \begin{itemize}
        \item 
          Ако $a$ се среща в $y$ или $v$, тогава $xy^2uv^2w$ съдържа повече $a$ от $b$.
        \item
          Ако $c$ се среща в $y$ или $v$, тогава $xy^0uv^0w$ съдържа по-малко $c$ от $b$.
        \end{itemize}
      \item
        $c$ не се среща в $y$ и $v$.
        Тогава $xy^2uv^2w$ съдържа повече $a$ или $b$ от $c$.
      \end{enumerate}      
     \item
       $y$ или $v$ е съставена от две букви.
       Тук разглеждаме $xy^2uv^2w$ и съобразяваме, че редът на буквите е нарушен.
     \end{itemize}    
   \end{description}
\end{proof}

\begin{problem}
  Докажете, че езикът $L = \{\beta\beta\mid \beta\in \{a,b\}^\star\}$ не е безконтекстен.
\end{problem}
\begin{hint}
  \marginpar{Защо $\alpha = a^pba^pb$ не става?}
  Разгледайте $\alpha = a^pb^pa^pb^p$.
\end{hint}

\begin{problem}
  Докажете, че езикът 
  \[L = \{\alpha\beta\alpha^{rev} \mid \alpha,\beta \in \{a,b\}^\star\ \&\ |\alpha| = |\beta|\}\]
  не е безконтекстен.
\end{problem}
\begin{hint}
  Разгледайте $\alpha = a^p b^p a^p b^p b^p a^p$.
  Покаваме с повече от $p$ би трябвало да свърши работа.
\end{hint}

\begin{framed}
  \begin{prop}
    Безконтекстните езици {\bf не} са затворени относно сечение и допълнение.
  \end{prop}
\end{framed}
\begin{proof}
  Да разгледаме езика
  \[L_0 = \{a^nb^nc^n\mid n\in\Nat\},\] за който вече знаем от \Prob{anbncn}, че не е безконтекстен.
  Да вземем също така и безконтекстните езици 
  \marginpar{\writedown Защо са безконтекстни?}
  \[L_1 = \{a^nb^nc^m\mid n,m\in\Nat\},\ L_2 = \{a^mb^nc^n\mid n,m\in\Nat\},\]
  \begin{itemize}
  \item 
    Понеже $L_0 = L_1\cap L_2$, то заключаваме, че безконтекстните езици не са затворени 
    относно операцията сечение.
  \item
    \marginpar{Озн. $\ov{L} = \Sigma^\star \setminus L$}
    Да допуснем, че безконтекстните езици са затворени относно операцията допълнение.
    Тогава  $\ov{L}_1$ и $\ov{L}_2$ са безконтекстни.
    Знаем, че безконтекстните езици са затворени относно обединение. 
    Следователно, езикът $L_3 = \ov{L}_1 \cup \ov{L}_2$ също е безконтекстен.
    Ние допуснахме, че безконтекстните са затворени относно допълнение, следователно $\ov{L}_3$
    също е безконтекстен.
    Но тогава получаваме, че езикът
    \[L_0 = L_1 \cap L_2 = \ov{\ov{L}_1 \cup \ov{L}_2} = \ov{L}_3\]
    е безконтекстен, което е противоречие.
  \end{itemize}
\end{proof}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../eai"
%%% End: 
