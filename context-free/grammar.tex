\section{Безконтекстни граматики}
\index{граматика!безконтекстна}
\marginpar{В \cite{papadimitriou} дефиницията е различна. Там $\Sigma \subseteq V$}
\marginpar{На англ. {\em context-free grammar}}
\marginpar{Други срещани наименования на български са {\em контекстно-свободна}, {\em контекстно-независима}}
В Раздел \ref{sect:regular-grammar} въведохме понятието граматика. След това видяхме как можем да опишем регулярните езици
със специален вид граматики, които нарекохме регулярни граматики.
Сега ще разгледаме още един вид граматики, които описват по-широк клас от езици.

\begin{itemize}
\item 
  Една граматика $G = (V, \Sigma, R, S)$ се нарича {\bf безконтекстна}, ако 
  имаме ограничението, че $R \subseteq V\times (V\cup\Sigma)^\star$.
\item
  \index{език!безконтекстен}
  $L$ се нарича {\bf безконтекстен език}, ако съществува безконтекстна граматика $G$, за която 
  $L = \L(G) = \{\omega \in \Sigma^\star \mid S \to^\star_G \omega\}$.
\end{itemize}

\begin{remark}
  Очевидно е, че всяка регулярна граматика е безконтекстна. Следователно, 
  {\em всеки регулярен език е безконтекстен.}
\end{remark}

Като първи пример нека да видим, че това включване е {\em строго}, т.е. съществува безконтекстен език, който не е регулярен.
Да напомним, че вече видяхме, че езикът $L = \{a^nb^n \mid n\in\Nat\}$ не е регулярен.

\begin{example}
  Да разгледаме безконтекстната граматика $G$ зададена със следните правила:
  \begin{align*}
    & S \to aSb \mid \varepsilon.
  \end{align*}
  Лесно се съобразява, че $\L(G) = \{a^nb^n \mid n\in\Nat\}$.
\end{example}

\begin{example}
  Да разгледаме безконтекстната граматика $G$ зададена със следните правила:
  \begin{align*}
    & S \to aSc\ |\  B\\
    & B \to bBc\ |\ \varepsilon.
  \end{align*}
  Лесно се съобразява, че $\L(G) = \{a^nb^kc^{n+k} \mid n,k\in\Nat\}$.
\end{example}

\begin{example}
  Да разгледаме граматика с правила
  \begin{align*}
    & S \to S + S\ |\ S * S\ |\ (S)\ |\ V\\
    & V \to x\ |\ y\ |\ z
  \end{align*}

  Думата $x * y + z$ има две различни дървета на извод.

  Да разгледаме граматика с правила
  \begin{align*}
    & S \to E + S\ |\ E\\
    & E \to V * E\ |\ V\ |\ (S) * E\ |\ (S)\\
    & V \to x\ |\ y\ |\ z
  \end{align*}
  Сега думата $x * y + z$ има само едно дърво на извод.
\end{example}

\begin{example}
  \begin{align*}
    & S \to \texttt{if } S \texttt{ then } S \texttt{ else }S\ |\ \texttt{ if }S \texttt{ then }S\ |\ V\\
    & V \to x\ |\ y\ |\ z
  \end{align*}

  Ние искаме следната граматика:
  \begin{align*}
    & S \to M\ |\ U\\
    & M \to \texttt{if } S \texttt{ then } M \texttt{ else }M\ |\ X\\
    & U \to \texttt{if } S \texttt{ then } S\ |\ \texttt{if } S \texttt{ then } M \texttt{ else }U
  \end{align*}
\end{example}

\begin{example}
  Да разгледаме граматика с правила
  \begin{align*}
    & S \to E\\
    & E \to E + P\ |\ P\\
    & P \to P * N\ |\ N\\
    & N \to (E)\ |\ a.
  \end{align*}
\end{example}

\begin{problem}
  Докажете, че езикът $L = \{a^mb^nc^k\mid m+k \geq n\}$ е безконтекстен.
\end{problem}


\begin{problem}
  Докажете, че езикът $L = \{a^mb^nc^k\mid m+n \geq k\}$ е безконтекстен.
\end{problem}
\begin{proof}
  Да разгледаме граматиката $G$ с правила
  \begin{align*}
    S& \rightarrow aSc\ |\ aS\ |\ B\\
    B& \rightarrow bBc\ |\  bB\ |\ \varepsilon.
  \end{align*}
  
  Лесно се вижда с индукция по $n$, че за всяко $n$ имаме свойствата:
  \marginpar{\ding{45} Докажете!}
  \begin{itemize}
  \item 
    $S \rightarrow^\star a^nSc^n$,
  \item
    $S \rightarrow^\star a^nS$,
  \item
    $B \rightarrow^\star a^nBc^n$,
  \item
    $B \rightarrow^\star b^nB$.
  \end{itemize}
  Комбинирайки горните свойства, можем да видим, че за всяко $n \geq k$,
  \begin{itemize}
  \item 
    $S \rightarrow^\star a^nSc^k$,
  \item
    $B \rightarrow^\star b^nBc^k$.
  \end{itemize}
  За да докажем, че $L \subseteq L(G)$, 
  да разгледаме една дума $\omega \in L$, т.е. $\omega = a^mb^nc^k$, където $m+n \geq k$.
  Имаме два случая:
  \begin{itemize}
  \item 
    $k \leq m$, т.е. $m = k+l$ и $m+n = k+l+n$.
    Тогава имаме изводите:
    \[S \rightarrow^\star a^kSc^k,\ S \rightarrow^\star a^lS,\ S \rightarrow B,\ B \rightarrow^\star b^nB,\ B \rightarrow \varepsilon.\]
    Обединявайки всичко това, получаваме:
    \[S \rightarrow^\star a^mb^nc^k.\]
  \item
    $k > m$, т.е. $k = m+l$, за някое $l > 0$, и $m+n = k+r = m+l+r$, за някое $r$.
    Тогава имаме изводите:
    \[S \rightarrow^\star a^mSc^m,\ S\rightarrow B,\ B\rightarrow^\star b^lBc^l,\ B\rightarrow b^rB,\ B\rightarrow\varepsilon,\]
    и отново получаваме $S \rightarrow^\star a^mb^nc^k$.
  \end{itemize}
  Така доказахме, че $\omega \in \L(G)$.
  
  Сега ще докажем, че $\L(G) \subseteq L$.
  С индукция по дължината на извода $l$,
  ще докажем, че ако $S \stackrel{l}{\rightarrow}\omega$, то $\omega \in M$, където
  \[M = \{a^nSc^k\mid n\geq k\}\cup\{a^nb^mBc^k\mid n+m\geq k\}\cup\{a^nb^mc^k\mid n+m\geq k\}.\]
  
  Ако $l = 0$, то е ясно, че $S \stackrel{0}{\rightarrow} S$ и $S \in M$.

  Нека $l > 0$ и $S \stackrel{l-1}{\rightarrow} \alpha \rightarrow \omega$.
  От {\bf И.П.} имаме, че $\alpha \in M$. Нека $\omega$ се получава от $\alpha$ с прилагане на правилото $C \rightarrow \gamma$.
  Разглеждаме всички варианти за думата $\alpha \in M$ и за правилото $C\rightarrow \gamma$ в граматиката $G$
  за да докажем, че  $\omega \in M$.
  Удобно е да представим всички случаи в таблица.
  \begin{center}
    \begin{tabular}{| c | c | c |}
      \hline
      $\alpha\in M$ & $C \rightarrow \gamma$ & $\omega \in M?$ \\ \hline
      $a^nSc^k$ & $S \rightarrow aSc$ & $a^{n+1}Sc^{k+1}$ \\ \hline
      $a^nSc^k$ & $S \rightarrow aS$ & $a^{n+1}Sc^{k}$ \\ \hline
      $a^nSc^k$ & $S \rightarrow B$ & $a^{n}Bc^{k}$ \\ \hline
      $a^nb^mBc^k$ & $B \rightarrow bBc$ & $a^nb^{m+1}Bc^{k+1}$\\ \hline
      $a^nb^mBc^k$ & $B \rightarrow bB$ & $a^nb^{m+1}Bc^{k}$\\ \hline
      $a^nb^mBc^k$ & $B \rightarrow \varepsilon$ & $a^nb^{m}c^{k}$\\ \hline
    \end{tabular}
  \end{center}
  Във всички случаи се установява, че $\omega \in M$.
  Сега, за всяка дума $\omega \in L(G)$ следва, че
  \[\omega \in \Sigma^\star \cap M = \{a^mb^nc^k\mid m+n \geq k\}.\]
\end{proof}

\begin{problem}
  Докажете, че езикът 
  \[L = \{a^nb^mc^kd^l \mid n+k = m + l\}\]
  е безконтекстен.
\end{problem}
\begin{hint}
  Нека $G_1$ е безконтекстна граматика за езика
  \[L_1 = \{a^nb^mc^k \mid m = n+k\},\]
  където правилата на $G_1$ са
  \[S_1 \to AC,\quad  A \to aAb\ |\ \varepsilon,\quad C \to bCc\ |\ \varepsilon.\]
  Нека $G_2$ е безконтекстна граматика за езика 
  \[L_2 = \{b^mc^kd^l \mid k = m+l\},\]
  където правилата на $G_2$ са
  \[S_2 \to BD,\quad B \to bBc\ |\ \varepsilon,\quad D \to cCd\ |\ \varepsilon.\]
  Тогава граматиката $G$ за $L$ 
  съдържа правилата на граматиките $G_1$ и $G_2$, а също и правилата
  \[S \to aSd\ |\ S_1\ |\ S_2.\]
\end{hint}

\begin{problem}
  Докажете, че езикът 
  \[L = \{a^nb^mc^kd^l \mid n+k \geq m + l\}\]
  е безконтекстен.
\end{problem}

\begin{problem}
  \marginpar{
    $S \to aS \mid aSc \mid aB \mid bB$\\
    $B \to bB \mid bBc \mid \varepsilon$
}
  Докажете, че езикът 
  \[L = \{a^mb^nc^k\mid m+n \geq k + 1\}\]
  е безконтекстен.  
\end{problem}

\begin{problem}
  \label{prob:equal-but-different}
  Докажете, че езикът
  \[L = \{\alpha\beta \in \{a,b\}^\star \mid\ |\alpha| = |\beta|\ \&\ \alpha \neq \beta\}\]
  е безконтекстен.
\end{problem}
\begin{hint}
  Разгледайте граматиката:
  \begin{align*}
    & S \to AB\ |\ BA\\
    & A \to XAX\ |\ a\\
    & B \to XBX\ |\ b\\
    & X \to a\ |\ b.
  \end{align*}
\end{hint}

\begin{problem}
  Докажете, че езикът
  \[L = \{\alpha \sharp \beta \mid \alpha,\beta \in \{a,b\}^\star\ \&\ |\alpha| \neq |\beta| \}\]
  е безконтекстен.
\end{problem}

\begin{problem}
 Докажете, че езикът
 \[L = \{\alpha \sharp \beta \mid \alpha,\beta \in \{a,b\}^\star\ \&\ \alpha \neq \beta \}\]
 е безконтекстен.
\end{problem}
\begin{hint}
  Разгледайте граматиката:
  \begin{align*}
    & S \to AaR\ |\ BbR\ |\ E\\
    & A \to XAX\ |\ bR\sharp\\
    & B \to XBX\ |\ aR\sharp\\
    & E \to XEX\ |\ XR\sharp\ |\ \sharp XR\\
    & R \to XR\ |\ \varepsilon\\
    & X \to a\ |\ b.
  \end{align*}
  Имаме, че за произволни думи $\alpha,\beta,\gamma,\delta \in \{a,b\}^\star$,
  \begin{align*}
    & S \to^\star \alpha b \gamma \sharp \beta a \delta\ \&\ |\alpha| = |\beta|,\\
    & S \to^\star \alpha a \gamma \sharp \beta b \delta\ \&\ |\alpha| = |\beta|, \text{ или}\\
    & S \to^\star \alpha \sharp \beta\ \&\ |\alpha| \neq |\beta|\\
  \end{align*}      
\end{hint}

\begin{problem}
  Нека $L_1$ и $L_2$ са произволни безконтекстни езици.
  Докажете, че:
  \begin{itemize}
  \item 
    $L_1 \cup L_2$ е безконтекстен език;
  \item
    $L_1 \cdot L_2$ е безконтекстен език;
  \item
    $L^\star_1$ е безконтекстен език.
  \end{itemize}
\end{problem}

\begin{problem}
  Да разгледаме граматиката $G$ с правила
  \[S \to AA\ |\ B,\ A \to B\ |\ bb,\ B \to aa\ |\ aB.\]
  Да се намери езика на тази граматика и да се докаже, че граматиката разпознава точно този език.
\end{problem}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../eai"
%%% End: 
